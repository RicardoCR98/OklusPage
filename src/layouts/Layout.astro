---
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import "../styles/global.css";
interface Props {
    title: string;
    description: string;
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{title}</title>
        <meta name="description" content={description} />

        <!-- SEO Keywords -->
        <meta name="keywords" content="software dental Ecuador, sistema gestión clínica dental, agenda pacientes dentales, software odontológico pequeñas clínicas, historial clínico digital, software consultorio dental, programa dentistas Ecuador, sistema dental sin internet, software clínica dental Quito, software clínica dental Guayaquil" />
        <meta name="author" content="Oklus" />
        <link rel="canonical" href="https://oklus.com" />

        <!-- Geo-targeting -->
        <meta name="geo.region" content="EC" />
        <meta name="geo.placename" content="Ecuador" />

        <!-- Preconnect for performance -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&display=swap"
            rel="stylesheet"
        />
        <link rel="icon" type="image/svg+xml" href="/OklusIcon.svg" />

        <!-- Open Graph / Social Media -->
        <meta property="og:type" content="website" />
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:url" content="https://oklus.com" />
        <meta property="og:locale" content="es_EC" />

        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />

        <!-- Theme color for mobile browsers -->
        <meta name="theme-color" content="#0d9488" />
    </head>
    <body class="bg-slate-50 text-slate-900">
        <Header />
        <main>
            <div class="mx-auto max-w-6xl px-6">
                <slot />
            </div>
        </main>
        <Footer />

        <!-- Image Lightbox Modal -->
        <div
            id="image-lightbox"
            class="fixed inset-0 z-50 hidden items-center justify-center bg-black/90 p-4 backdrop-blur-sm"
            role="dialog"
            aria-modal="true"
            aria-label="Imagen ampliada"
        >
            <!-- Close button -->
            <button
                id="close-lightbox"
                class="absolute right-4 top-4 z-10 rounded-lg bg-white/10 p-2 text-white transition hover:bg-white/20"
                aria-label="Cerrar imagen"
            >
                <svg
                    class="h-6 w-6"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>

            <!-- Image container -->
            <div class="max-h-full max-w-full">
                <img
                    id="lightbox-image"
                    src=""
                    alt=""
                    class="max-h-[90vh] w-auto rounded-lg shadow-2xl"
                />
            </div>
        </div>

        <script>
            // Lightbox functionality
            const lightbox = document.getElementById("image-lightbox");
            const lightboxImage = document.getElementById(
                "lightbox-image",
            ) as HTMLImageElement;
            const closeButton = document.getElementById("close-lightbox");

            // Function to open lightbox
            function openLightbox(src: string, alt: string) {
                if (lightbox && lightboxImage) {
                    lightboxImage.src = src;
                    lightboxImage.alt = alt;
                    lightbox.classList.remove("hidden");
                    lightbox.classList.add("flex");
                    document.body.style.overflow = "hidden";
                }
            }

            // Function to close lightbox
            function closeLightbox() {
                if (lightbox) {
                    lightbox.classList.add("hidden");
                    lightbox.classList.remove("flex");
                    document.body.style.overflow = "";
                }
            }

            // Close on button click
            closeButton?.addEventListener("click", closeLightbox);

            // Close on background click
            lightbox?.addEventListener("click", (e) => {
                if (e.target === lightbox) {
                    closeLightbox();
                }
            });

            // Close on Escape key
            document.addEventListener("keydown", (e) => {
                if (
                    e.key === "Escape" &&
                    lightbox &&
                    !lightbox.classList.contains("hidden")
                ) {
                    closeLightbox();
                }
            });

            // Make all product images clickable
            document.addEventListener("DOMContentLoaded", () => {
                const productImages =
                    document.querySelectorAll(".product-image");
                productImages.forEach((img) => {
                    img.addEventListener("click", () => {
                        const src = img.getAttribute("src") || "";
                        const alt = img.getAttribute("alt") || "";
                        openLightbox(src, alt);
                    });
                });
            });

            // Expose to window for potential external use
            (window as any).openLightbox = openLightbox;
        </script>
    </body>
</html>
